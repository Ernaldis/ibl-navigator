<h4>
  List of Sessions:
</h4>
<form [formGroup]="session_filter_form">
  <div class="filters">
    <mat-form-field class="long">
      <label for="">Task Protocol</label>
      <input matInput type="text" name="task_protocol" formControlName="task_protocol_control"  [matAutocomplete]="auto" (focus)="stepBackMenu($event)" >
      <mat-autocomplete #auto="matAutocomplete">
        <mat-option *ngFor="let tp of filteredTaskProtocolOptions | async" [value]="tp" (click)="updateMenu()">{{ tp }}</mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <mat-form-field class="short">
      <label for="">Session Start</label>
      <input matInput formControlName="session_date_control" [matDatepicker]="datePicker" [min]="sessionMinDate" [max]="sessionMaxDate" [matDatepickerFilter]="sessionDateFilter" (blur)="updateMenu()" (focus)="stepBackMenu($event)">
      <mat-datepicker-toggle matSuffix [for]="datePicker"></mat-datepicker-toggle>
      <mat-datepicker #datePicker></mat-datepicker>
    </mat-form-field>

    <mat-form-field class="long">
      <label for="">Session UUID</label>
      <input matInput type="text" name="session_uuid" formControlName="session_uuid_control" [matAutocomplete]="auto2" (focus)="stepBackMenu($event)">
      <mat-autocomplete #auto2="matAutocomplete">
        <mat-option *ngFor="let sessionUuid of filteredSessionUuidOptions | async" [value]="sessionUuid" (click)="updateMenu()">{{ sessionUuid }}</mat-option>
      </mat-autocomplete>
    </mat-form-field> 

    <div class="mouse_gender_menu" formArrayName="sex_control">
      <label (dblclick)="stepBackMenu($event)">Gender</label>
      <!-- <div *ngFor="let gender of mouse_filter_form.controls.sex_control.controls; let i=index"> -->
      <mat-checkbox class="mouse_gender_menu_button" [name]="session_menu.sex[i]" [formControlName]="i"
        *ngFor="let gender of session_filter_form.controls.sex_control.controls; let i=index" [value]="gender.value"
        (change)="updateMenu()">{{ session_menu.sex[i] }}</mat-checkbox>
      <!-- </div> -->
    </div>
    
    <mat-form-field>
      <label>Labs</label>
      <input matInput type="text" name="lab_name" formControlName="lab_name_control" [matAutocomplete]="autoCompLN"
        (focus)="stepBackMenu($event)">
      <mat-autocomplete #autoCompLN="matAutocomplete">
        <mat-option *ngFor="let lab of filteredLabNameOptions | async" [value]="lab" (click)="updateMenu()">
          {{ lab }}</mat-option>
      </mat-autocomplete>
    </mat-form-field>
    
    <mat-form-field>
      <label>Mouse Nickname</label>
      <input matInput type="text" name="subject_nickname" formControlName="subject_nickname_control"
        [matAutocomplete]="autoCompSN" (focus)="stepBackMenu($event)">
      <mat-autocomplete #autoCompSN="matAutocomplete">
        <mat-option *ngFor="let nickname of filteredSubjectNicknameOptions | async" [value]="nickname"
          (click)="updateMenu()">
          {{ nickname }}</mat-option>
      </mat-autocomplete>
    </mat-form-field>
    
    <mat-form-field class="long">
      <label>Mouse UUID</label>
      <input matInput type="text" name="subject_uuid" formControlName="subject_uuid_control"
        [matAutocomplete]="autoCompSUUID" (focus)="stepBackMenu($event)">
      <mat-autocomplete #autoCompSUUID="matAutocomplete">
        <mat-option *ngFor="let uuid of filteredSubjectUuidOptions | async" [value]="uuid" (click)="updateMenu()">
          {{ uuid }}</mat-option>
      </mat-autocomplete>
    </mat-form-field>
    
    <mat-form-field class="short">
      <label>DOB</label>
      <input matInput formControlName="subject_birth_date_control" [matDatepicker]="DOBPicker"
        [matDatepickerFilter]="miceBirthdayFilter" (blur)="updateMenu()" (focus)="stepBackMenu($event)"
        placeholder="DOB - i.e. 10/23/2018">
      <mat-datepicker-toggle matSuffix [for]="DOBPicker"></mat-datepicker-toggle>
      <mat-datepicker #DOBPicker></mat-datepicker>
    </mat-form-field>
    
    <mat-form-field>
      <label>Line</label>
      <input matInput type="text" name="subject_line" formControlName="subject_line_control" [matAutocomplete]="autoCompSL"
        (focus)="stepBackMenu($event)">
      <mat-autocomplete #autoCompSL="matAutocomplete">
        <mat-option *ngFor="let line of filteredSubjectLineOptions | async" [value]="line" (click)="updateMenu()">
          {{ line }}</mat-option>
      </mat-autocomplete>
    </mat-form-field>
    
    <mat-form-field>
      <label>User</label>
      <input matInput type="text" name="responsible_user" formControlName="responsible_user_control"
        [matAutocomplete]="autoCompRU" (focus)="stepBackMenu($event)">
      <mat-autocomplete #autoCompRU="matAutocomplete">
        <mat-option *ngFor="let responsible_user of filteredResponsibleUserOptions | async" [value]="responsible_user"
          (click)="updateMenu()">{{ responsible_user }}</mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </div>
  <div>
    <button mat-raised-button (click)="applyFilter()">Apply Filter</button>
  </div>
</form>


<table mat-table class="col-12" [dataSource]="dataSource">

  <ng-container matColumnDef="labName">
    <th mat-header-cell *matHeaderCellDef> Lab </th>
    <td mat-cell *matCellDef="let session"> {{session.lab_name}} </td>
  </ng-container>
  
  <ng-container matColumnDef="subjectNickname">
    <th mat-header-cell *matHeaderCellDef> Mouse Nickname </th>
    <td mat-cell *matCellDef="let session"> {{session.subject_nickname}} </td>
  </ng-container>
  
  <ng-container matColumnDef="taskProtocol">
    <th mat-header-cell *matHeaderCellDef> Task Protocol </th>
    <td mat-cell *matCellDef="let session"> {{session.task_protocol}} </td>
  </ng-container>

  <ng-container matColumnDef="subjectLine">
    <th mat-header-cell *matHeaderCellDef> Line </th>
    <td mat-cell *matCellDef="let session"> {{session.subject_line}} </td>
  </ng-container>

  <ng-container matColumnDef="responsibleUser">
    <th mat-header-cell *matHeaderCellDef> User </th>
    <td mat-cell *matCellDef="let session"> {{session.responsible_user}} </td>
  </ng-container>

  <ng-container matColumnDef="sessionStart">
    <th mat-header-cell *matHeaderCellDef> Session Date </th>
    <td mat-cell *matCellDef="let session"> {{session.session_start_time | date}} </td>
  </ng-container>

  <ng-container matColumnDef="subjectDOB">
    <th mat-header-cell *matHeaderCellDef> Mouse DOB </th>
    <td mat-cell *matCellDef="let session"> {{session.subject_birth_date | date}} </td>
  </ng-container>

  <ng-container matColumnDef="subjectUUID">
    <th mat-header-cell *matHeaderCellDef> Mouse UUID </th>
    <td mat-cell *matCellDef="let session"> {{session.subject_uuid}} </td>
  </ng-container>

  <ng-container matColumnDef="sessionUUID">
    <th mat-header-cell *matHeaderCellDef> Session UUID </th>
    <td mat-cell *matCellDef="let session"> {{session.session_uuid}} </td>
  </ng-container>

  <ng-container matColumnDef="gender">
    <th mat-header-cell *matHeaderCellDef> Gender </th>
    <td mat-cell *matCellDef="let session"> {{session.sex}} </td>
  </ng-container>
  
  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns; let session" routerLink="/session/{{session?.session_uuid}}">
  </tr>
</table>
<mat-paginator [pageSize]="pageSize"
            [pageSizeOptions]="pageSizeOptions"
            showFirstLastButtons></mat-paginator>
<!-- <div class="sessionsList row">
  <div *ngFor="let session of sessions">
    <a routerLink="/session/{{session['session_uuid']}}">
      <mat-card (click)="sessionSelected(session)">
        <h6>Session UUID</h6>
        <mat-card-subtitle>{{ session['session_uuid'] }}</mat-card-subtitle>
        <h6>Session Date</h6>
        <mat-card-subtitle>{{ session['session_start_time'] | date}}</mat-card-subtitle>
        <h6>Mouse Nickname</h6>
        <mat-card-subtitle>{{ session['subject_nickname'] }}</mat-card-subtitle>
        <h6>Lab Name</h6>
        <mat-card-subtitle>{{ session['lab_name'] }}</mat-card-subtitle>
        <h6>Task Protocol</h6>
        <mat-card-subtitle>{{ session['task_protocol'] }}</mat-card-subtitle>
        <h6>Mouse Line</h6>
        <mat-card-subtitle>{{ session['subject_line'] }}</mat-card-subtitle>
        <h6>Mouse DOB</h6>
        <mat-card-subtitle>{{ session['subject_birth_date'] }}</mat-card-subtitle>
      </mat-card>
    </a>
  </div>
</div> -->